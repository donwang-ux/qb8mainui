(function(){function u(e,t,n){var r=this.model=new o,i=function(e){return typeof e=="object"?e:document.getElementById(e)},s=function(e){return document.createElement(e)},u=this,a=i(e),f={},l=!1,h=-1,p=[],d=[],v="",m="",g=null,y=!1,b=0,w=function(){for(pos in p)p[pos].className="mouseout"},E=function(e){return typeof e=="string"?e.replace(/^\s\s*/,"").replace(/\s\s*$/,""):""},S=E(a.value),x=function(){typeof t=="function"&&t()},T=function(){$("#poparea").addClass("panelHide");$("#poparea").removeClass("panelShow");$("#toolbar").removeClass("pop");$("#webmask").hide();y=!1;h=-1;p=[];d=[];v="";var e=i(b);e&&e!=null&&e.parentNode.removeChild(e)},N=function(e,t){return t.indexOf(e)!=0?t:e+"<strong>"+t.substr(e.length)+"</strong>"},C=function(){var e=s("li");e.id=b="soso_SmartPop_"+Math.round(Math.random()*1e5);e.className="soso_SmartPop";e.style.height=""+d.length*26+"px";$("#toolbar").addClass("pop");$("#poparea").show();$("#poparea").removeClass("panelHide");$("#poparea").addClass("panelShow");$("#webmask").show();$("div.taobaosuggest ul").empty();for(var t=0,n=d.length;t<n;t++){var r=s("div");r.seq=parseInt(t);(function(){var e=r;u.Event.add(r,"mouseover",function(){w();e.className="mouseover";h=e.seq})})();(function(){u.Event.add(r,"mouseout",function(){w();h=-1})})();(function(){u.Event.add(r,"click",function(){S=m=a.value=d[h].word;x()})})();var i=s("div");i.innerHTML=N(a.value,d[t].word);r.appendChild(i);e.appendChild(r);p.push(r)}return e},k=function(e){if(!y&&(e.keyCode==38||e.keyCode==40)){l=!0;H()}if(e.keyCode==13){u.Event.stop(e);S=a.value;x()}},L=function(e){if(!y&&(e.keyCode==38||e.keyCode==40)){l=!0;H()}if(p.length==0)return;if(e.keyCode==13&&h!=-1){u.Event.stop(e);S=a.value;x()}else if(e.keyCode==38){u.Event.stop(e);w();h=h<0?p.length-1:h-1;if(h==-1)v=a.value=m;else{p[h].className="mouseover";v=a.value=d[h].word}}else if(e.keyCode==40){u.Event.stop(e);w();h=h>p.length-1?0:h+1;if(h==p.length)v=a.value=m;else{p[h].className="mouseover";v=a.value=d[h].word}}else if(e.keyCode==27){u.Event.stop(e);w();T();a.value=m;$("#poparea").hide()}},A=function(e){document.getElementById("poparea").appendChild(e);y=!0},O=function(e){l=!0;T();m=v=a.value;d=P(e);if(d.length>0){c=C();A(c)}},M="soso_jpcall_"+Math.round(1e6+Math.random()*1e7);window[M]=function(e){try{O(e)}catch(t){r.setDeafultSmartbox()}};window.sugCls={handleContent:O};window.MusicJsonCallback=O;var _=function(){y||r.setDeafultSmartbox()},D=function(){soso_global_smartbox_data=[];l=!1;r.getData(a.value,window[M],_)},P=function(e){return r.parseData(e)},H=function(){if(g!=null){clearTimeout(g);g=null}g=setTimeout(function(){if(!l||E(a.value).length==0){T();$("#poparea").hide()}else n()&&v!=a.value&&D();g=null},300)};(function(){u.Event.add(a,"keypress",function(e){k(e)});u.Event.add(a,"keyup",function(e){L(e)});u.Event.add(window,"resize",function(){l&&D()});var e,t=function(){e=setTimeout(function(){if(S!=E(a.value)){S=E(a.value);l=!0;H()}e=setTimeout(arguments.callee,80)},80)},n=function(){clearTimeout(e)},r=!0;$("#omniinput").click(function(e){if($("#omniinput").hasClass("open")==0){$("#omniinput").addClass("open");r=!0}e.stopPropagation();if(r){$("#omniinput").select();r=!1}$("#omniinput").val()!=""&&$("#poparea").removeClass("hide");return!1});u.Event.add(a,"focus",function(){t();a.setAttribute("placeholder","");if($("#omniinput").hasClass("open")==0){$("#omniinput").addClass("open");D();r=!0;return!1}});u.Event.add(a,"blur",function(){n()})})()}var e={storage:window.localStorage,set:function(e,t,n){if(!e||!t)return!1;n=n||31536e6;var r=(new Date).getTime();try{var i={expires:r+n,rawData:t};this.storage.set(e,JSON.stringify(i))}catch(s){return!1}return!0},get:function(e){if(!e||e==="undefined")return null;var t;try{t=this.storage.get(e)}catch(n){return null}if(!t)return null;try{t=JSON.parse(t);if(t&&typeof t=="object"&&typeof t.expires=="number"&&typeof t.rawData!="undefined"){var r=(new Date).getTime();if(r<=t.expires)return t.rawData}}catch(n){return null}return null}},t={trim:function(e){return typeof e=="string"?e.replace(/^\s+/,"").replace(/\s+$/,""):""}},n=function(e){e=e.s;var t=[];for(var n=0;n<e.length;n++)t.push({word:e[n],hint:"",type:""});return t},r=function(e){var t=e[1],n=[];for(var r=0;r<t.length;r++)n.push({word:t[r][0],hint:0,type:0});return n},i=function(e){var t=e.AS.Results[0].Suggests,n=[];for(var r=0;r<t.length;r++)n.push({word:t[r].Txt.replace(/<strong>/g,"").replace(/<\/strong>/g,""),hint:0,type:0});return n},s={_default:{_default:{url:"http://suggestion.baidu.com/su?",key:"wd",jsonp:"cb",charset:"gbk",parseData:n}},web:{baidu:{url:"http://suggestion.baidu.com/su?",key:"wd",jsonp:"cb",charset:"gbk",parseData:n},sogou:{},google:{url:"http://www.google.com.hk/complete/search?",key:"q",jsonp:"callback",params:{hl:"zh-CN",client:"hp"},parseData:r},bing:{url:"http://api.bing.com/qsonhs.aspx?",key:"q",jsonp:"cb",params:{mkt:"zh-CN",type:"cb",o:"a+ds+ds+h+p"},parseData:i}}};s.web.sogou=s._default._default;s.web._default=s.web.baidu;var o=function(){this.params={};this.engin="_default";this.channel="_default";return this};o.prototype.setParam=function(e,t){this.params[e]=encodeURIComponent(t);return this};o.prototype.getParam=function(e,t){return this.params[e]};o.prototype.getJSONP=function(){var e=s[this.channel][this.engin].jsonp||"callback";return e};o.prototype.getCharset=function(){var e=s[this.channel][this.engin].charset||"utf-8";return e};o.prototype.getQueryUrl=function(e){var n=this.engin||"_default",r=this.channel||"_default",i={},o=s[r]&&s[r][n];if(!o)return"";if(!t.trim(e))return o.home;if(typeof o.url=="function")return o.url(e);i[o.key||"w"]=encodeURIComponent(e);for(var u in o.params)typeof o.params[u]=="function"?i[u]=o.params[u](e):typeof u=="string"&&(i[u]=o.params[u]);for(u in this.params)i[u]=this.params[u];var a=o.url.indexOf("?")===-1?o.url+"?":o.url,f=[];for(u in i)f.push(u+"="+i[u]);return a+f.join("&")};o.prototype.getData=function(e,t,n){var r=this.engin||"_default",i=this.channel||"_defualt";this.setParam("_",Date.parse(new Date));var s=this.getJSONP(),o=this.getQueryUrl(e),u=this.getCharset();window.qqnewtab_cb=t;$.ajax({url:o,dataType:"jsonp",contentType:"application/script",jsonp:s,jsonpCallback:"qqnewtab_cb",charset:u,timeout:2e3,error:n})};o.prototype.parseData=function(e){var t=this.engin||"_default",n=this.channel||"_default";return s[n][t].parseData(e)};o.prototype.changeSmartbox=function(e,t){this.engin=t;this.channel=e};o.prototype.setDeafultSmartbox=function(){if(this.channel=="_default")return!1;this.engin!=="_default"?this.engin="_default":this.channel="_default";return!0};u.prototype.Event={add:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent("on"+t,n)},remove:function(e,t,n){e.removeEventListener?e.removeEventListener(t,n,!1):e.detachEvent("on"+t,n)},stop:function(e){if(e.preventDefault){e.preventDefault();e.stopPropagation()}else{e.cancelBubble=!0;e.returnValue=!1}}};u.prototype.changeSmartbox=function(e,t){this.model.changeSmartbox(e,t)};var a="channel:",f={web:"baidu"},l={web:"web2"},h={web:{baidu:{home:"http://www.baidu.com/",url:"http://www.baidu.com/s?",key:"wd"},sogou:{home:"http://www.sogou.com/",url:"http://www.sogou.com/web?",key:"query"},google:{home:"https://www.google.com.hk/",url:"http://www.google.com.hk/search?",key:"q"},bing:{home:"http://cn.bing.com/",url:"http://cn.bing.com/search",key:"q"},soso:{home:"http://www.soso.com/",url:"http://www.soso.com/q?"}}},p=function(){this.params={};var t;this.channel="web";if(l[this.channel]){t=e.get(a+l[this.channel]);t&&(f[this.channel]=t)}this.engin=f[this.channel];return this};p.prototype.setEngin=function(t,n){this.engin=t;if(f[this.channel]!=t){f[this.channel]=t;e.set(a+l[this.channel],t)}!n||!n.silent;return this};p.prototype.getEginsAll=function(e){return h[e]||{}};p.prototype.getEginsNum=function(e){var t=h[e]||{},n=0;for(var r in t)++n;return n};p.prototype.setChannel=function(t,n){this.channel=t;if(l[this.channel]){engin=e.get(a+l[this.channel]);engin&&(f[t]=engin)}this.setEngin(f[t]);(!n||!n.silent)&&this.notify("change_channel",t);return this};p.prototype.setParam=function(e,t){this.params[e]=encodeURIComponent(t);return this};p.prototype.getParam=function(e,t){return this.params[e]};p.prototype.getEnginNumber=function(){return this.channel==="web"?3:1};p.prototype.getQueryUrl=function(e,n,r){r=r||this.engin||"soso";n=n||this.channel||"web";var i={},s=h[n]&&h[n][r];if(!s)return"";if(!t.trim(e))return s.home;if(typeof s.url=="function")return s.url(e);for(var o in s.params)typeof s.params[o]=="function"?i[o]=s.params[o](e):typeof o=="string"&&(i[o]=s.params[o]);for(o in this.params)i[o]=this.params[o];i.ie="utf-8";i[s.key||"w"]=encodeURIComponent(e);var u=s.url.indexOf("?")===-1?s.url+"?":s.url,a=[];for(o in i)a.push(o+"="+i[o]);return u+a.join("&")};var d=null,v=function(){chrome.send("qqnewtab.search.report",[g.engin]);var e=arguments[0]||$("#omniinput").val();window.open(g.getQueryUrl(e))},m=null,g=new p,y=null,b="chrome://resources/images/qqnewtab/favicon_search_",w=null,E={baidu:{"default":"baidu",title:"百度",css:"baidu",icon:"baidu"},sogou:{"default":"sogou",title:"搜狗",css:"sogou",icon:"sogou"},google:{"default":"google",title:"Google",css:"google",icon:"google"},bing:{"default":"bing",icon:"bing",css:"bing",title:"Bing"},soso:{"default":"soso",title:"SOSO",css:"soso",icon:"soso"}},S=function(){d=new u($("#omniinput")[0],function(){v()},function(){return!0});m=$("div.omnibox");y=m.find("div.suggestlayerout ul");w=m.find("div.searchChangeBtn").eq(0)},x=function(e,t){g.setEngin(t);d.changeSmartbox(e,t);var n="",r=g.getEginsNum(e),i=w.find("img");if(E[t]){var s='<img src="'+b+E[t].icon+'.png" />';i.length&&i.remove();w.find("div.searchEngineLogo").prepend(s);r<=1?w.find("span.arrowsdown").addClass("off"):w.find("span.arrowsdown").removeClass("off");$("#searchdropdown").hide();$("#searchBtn").attr("value",E[t].title+"搜索");$("#searchHint").html("搜索")}},T=function(e){var t=g.getEginsAll(e),n="",r=0;for(var i in t)if(E[i]){++r;n+='<li title="切换为'+E[i].title+'搜索" engin="'+i+'"><span class="icon"><img width="16" height="16" src="'+b+E[i].icon+'.png" /></span>'+E[i].title+"</li>"}if(r>1){y.html(n);y.find("li:first").addClass("fr");y.find("li:last").addClass("ls");y.parent().show()}};S()})();